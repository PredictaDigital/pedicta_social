Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 58, in get
    time_range_str = json.dumps(time_range)
                     ^^^^
NameError: name 'json' is not defined. Did you forget to import 'json'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 98080
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 67, in get
    response = requests.get(url, params=params)
                                        ^^^^^^
NameError: name 'params' is not defined
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 98923
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 67, in get
    response = requests.get(url, params=params)
                                        ^^^^^^
NameError: name 'params' is not defined
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 98923
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 31, in get
    latest_insight = FBAdsInsight.objects.filter(email='user@example.com').latest('created_at')
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 1085, in latest
    return self.reverse()._earliest(*fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 1068, in _earliest
    return obj.get()
           ^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 649, in get
    raise self.model.DoesNotExist(
facebook_app.models.FBAdsInsight.DoesNotExist: FBAdsInsight matching query does not exist.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 36, in get
    print(latest_insight.ad_name)
          ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'ad_name'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 115400
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 38, in get
    created_at = datetime.fromisoformat(created_at.replace("Z", "+00:00"))
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'str' object cannot be interpreted as an integer
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97205
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 38, in get
    created_at = created_at[:10]
                 ~~~~~~~~~~^^^^^
TypeError: 'datetime.datetime' object is not subscriptable
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 96927
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 46, in get
    today = datetime.datetime.today().strftime('%Y-%m-%d')
            ^^^^^^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97215
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 44, in get
    today = datetime.datetime.today().strftime('%Y-%m-%d')
            ^^^^^^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97215
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 44, in get
    today = datetime.datetime.today().strftime('%Y-%m-%d')
            ^^^^^^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97215
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 46, in get
    today = datetime.datetime.today().strftime('%Y-%m-%d')
            ^^^^^^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97033
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 46, in get
    today = datetime.datetime.today().strftime('%Y-%m-%d')
            ^^^^^^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97033
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 37, in get
    datetime_obj = datetime.fromisoformat(created_at.replace("Z", "+00:00"))
                   ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'fromisoformat'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97229
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 38, in get
    datetime_obj = datetime.fromisoformat(created_at.replace("Z", "+00:00"))
                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'str' object cannot be interpreted as an integer
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97185
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 38, in get
    datetime_str = datetime_str.replace("Z", "")
                   ^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime_str' where it is not associated with a value
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97320
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 38, in get
    datetime_str = created_at.replace("Z", "")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'str' object cannot be interpreted as an integer
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97072
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 39, in get
    datetime_str = created_at.replace("Z", "")
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'str' object cannot be interpreted as an integer
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97117
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 40, in get
    datetime_str = created_at.replace("Z", "")  # Remove 'Z' from the string
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'str' object cannot be interpreted as an integer
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97199
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 46, in get
    today = datetime.datetime.today().strftime('%Y-%m-%d')
            ^^^^^^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 96829
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 34, in get
    latest_insight = FBAdsInsight.objects.filter(email=email).latest('created_at')
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 1085, in latest
    return self.reverse()._earliest(*fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 1067, in _earliest
    obj.query.add_ordering(*order_by)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\sql\query.py", line 2253, in add_ordering
    self.names_to_path(item.split(LOOKUP_SEP), self.model._meta)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\sql\query.py", line 1772, in names_to_path
    raise FieldError(
django.core.exceptions.FieldError: Cannot resolve keyword 'created_at' into field. Choices are: account_currency, account_id, account_name, ad_id, ad_name, adset_id, adset_name, buying_type, campaign_id, campaign_name, clicks, cpc, cpm, cpp, created_time, ctr, data_created_date, data_created_time, email, frequency, id, impressions, objective, reach, spend, unique_ctr, updated_time
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 119242
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 45, in get
    if created_at is not None:  # Check if created_at is not null
       ^^^^^^^^^^
UnboundLocalError: cannot access local variable 'created_at' where it is not associated with a value
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 96843
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 49, in get
    untilldate = (datetime.now() - timedelta(days=36 * 30)).strftime('%Y-%m-%d')
                  ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 96942
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 49, in get
    untilldate = (today - timedelta(days=36 * 30)).strftime('%Y-%m-%d')
                          ^^^^^^^^^
NameError: name 'timedelta' is not defined
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 96780
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 46, in get
    today = datetime.datetime.today().strftime('%Y-%m-%d')
            ^^^^^^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 96806
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 46, in get
    today = datetime.datetime.today().strftime('%Y-%m-%d')
            ^^^^^^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 96808
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 46, in get
    today = datetime.datetime.today().strftime('%Y-%m-%d')
            ^^^^^^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 96859
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 47, in get
    today = datetime.datetime.today().strftime('%Y-%m-%d')
            ^^^^^^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 96822
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 46, in get
    today = datetime.datetime.today().strftime('%Y-%m-%d')
            ^^^^^^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 96822
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 52, in get
    month = ((today.month - dec - 1) % 12) + 1  # Ensure the month is within 1-12
              ^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'month'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97162
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 48, in get
    untilldate = datetime(year, month, day)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'module' object is not callable. Did you mean: 'datetime.datetime(...)'?
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97814
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 39, in get
    today = datetime.datetime.today()
            ^^^^^^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 96718
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 44, in get
    now = datetime.today()
          ^^^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'today'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 96670
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 39, in get
    today = datetime.datetime.today()
            ^^^^^^^^^^^^^^^^^
AttributeError: type object 'datetime.datetime' has no attribute 'datetime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 96718
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 47, in get
    untilldate = now - timedelta(days=36*30)  # Rough estimate (36 months)
                       ^^^^^^^^^
NameError: name 'timedelta' is not defined
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 96864
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 66, in get
    url_with_params = f"{url}?fields={','.join(fields)}&time_range={json.dumps(time_range)}&level=ad&access_token={access_token}"
                                                                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\json\__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\json\encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\json\encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type datetime is not JSON serializable
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 117584
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 53, in get
    time_range = {"since": sincedate.strftime('%Y-%m-%d'), "until": today.strftime('%Y-%m-%d')}
                           ^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'strftime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97438
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 119, in get
    "untill": sincedate.strftime('%Y-%m-%d')
              ^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'strftime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 99218
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 119, in get
    "untill": sincedate.strftime('%Y-%m-%d')
              ^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'strftime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 99218
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 118, in get
    "untill": sincedate.strftime('%Y-%m-%d')
              ^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'strftime'
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 99217
Internal Server Error: /facebook_app/facebook_ads-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Ads_Insights.py", line 47, in get
    sincedates = now - timedelta(months=37)  # Rough estimate (36 months)
                       ^^^^^^^^^^^^^^^^^^^^
TypeError: 'months' is an invalid keyword argument for __new__()
"GET /facebook_app/facebook_ads-insights/ HTTP/1.1" 500 97098
Internal Server Error: /facebook_app/facebook_campaign-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\mssql\base.py", line 677, in execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'FacebookCampaignInsights'. (208) (SQLExecDirectW); [42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Campaign_Insights.py", line 33, in get
    if FacebookCampaignInsight.objects.filter(email=email).exists():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 1288, in exists
    return self.query.has_results(using=self.db)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\sql\query.py", line 659, in has_results
    return compiler.has_results()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1530, in has_results
    return bool(self.execute_sql(SINGLE))
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1562, in execute_sql
    cursor.execute(sql, params)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\mssql\base.py", line 677, in execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'FacebookCampaignInsights'. (208) (SQLExecDirectW); [42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
"GET /facebook_app/facebook_campaign-insights/ HTTP/1.1" 500 157786
Internal Server Error: /facebook_app/facebook_campaign-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Campaign_Insights.py", line 93, in get
    FacebookCampaignInsight.objects.create(
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 677, in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\base.py", line 567, in __init__
    raise TypeError(
TypeError: FacebookCampaignInsight() got unexpected keyword arguments: 'status', 'start_time', 'stop_time', 'effective_status', 'skan_campaign_id'
"GET /facebook_app/facebook_campaign-insights/ HTTP/1.1" 500 126551
Internal Server Error: /facebook_app/facebook_campaign-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Campaign_Insights.py", line 93, in get
    FacebookCampaignInsight.objects.create(
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 677, in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\base.py", line 567, in __init__
    raise TypeError(
TypeError: FacebookCampaignInsight() got unexpected keyword arguments: 'status', 'start_time', 'stop_time', 'effective_status', 'skan_campaign_id'
"GET /facebook_app/facebook_campaign-insights/ HTTP/1.1" 500 125506
Internal Server Error: /facebook_app/facebook_campaign-insights/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\mssql\base.py", line 677, in execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'FB_Campaign_insigths'. (208) (SQLExecDirectW); [42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Campaign_Insights.py", line 33, in get
    if FacebookCampaignInsight.objects.filter(email=email).exists():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 1288, in exists
    return self.query.has_results(using=self.db)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\sql\query.py", line 659, in has_results
    return compiler.has_results()
           ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1530, in has_results
    return bool(self.execute_sql(SINGLE))
                ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1562, in execute_sql
    cursor.execute(sql, params)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\mssql\base.py", line 677, in execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.ProgrammingError: ('42S02', "[42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid object name 'FB_Campaign_insigths'. (208) (SQLExecDirectW); [42S02] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
"GET /facebook_app/facebook_campaign-insights/ HTTP/1.1" 500 157792
Internal Server Error: /facebook_app/facebook_get-followers/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Followers_Statistics.py", line 77, in get
    FacebookCampaignInsight.objects.create(
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 677, in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\base.py", line 567, in __init__
    raise TypeError(
TypeError: FacebookCampaignInsight() got unexpected keyword arguments: 'end_time', 'page_follows'
"GET /facebook_app/facebook_get-followers/ HTTP/1.1" 500 126504
Internal Server Error: /facebook_app/facebook_get-followers/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Followers_Statistics.py", line 47, in get
    if FacebookFollowersInsight.objects.filter(email=email).exists():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 1476, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 1494, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 1501, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\sql\query.py", line 1613, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\sql\query.py", line 1645, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\sql\query.py", line 1495, in build_filter
    lookups, parts, reffed_expression = self.solve_lookup_type(arg, summarize)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\sql\query.py", line 1307, in solve_lookup_type
    _, field, _, lookup_parts = self.names_to_path(lookup_splitted, self.get_meta())
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\sql\query.py", line 1772, in names_to_path
    raise FieldError(
django.core.exceptions.FieldError: Cannot resolve keyword 'email' into field. Choices are: data_created_date, data_created_time, end_time, id, page_follows
"GET /facebook_app/facebook_get-followers/ HTTP/1.1" 500 142980
Internal Server Error: /facebook_app/facebook_get-followers/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\mssql\base.py", line 677, in execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'end_time'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'page_follows'. (207); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Followers_Statistics.py", line 98, in get
    FacebookFollowersInsight.objects.create(
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 679, in create
    obj.save(force_insert=True, using=self.db)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\base.py", line 822, in save
    self.save_base(
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\base.py", line 909, in save_base
    updated = self._save_table(
              ^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\base.py", line 1071, in _save_table
    results = self._do_insert(
              ^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\base.py", line 1112, in _do_insert
    return manager._insert(
           ^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\query.py", line 1847, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\models\sql\compiler.py", line 1823, in execute_sql
    cursor.execute(sql, params)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\mssql\base.py", line 677, in execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'end_time'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'page_follows'. (207); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
"GET /facebook_app/facebook_get-followers/ HTTP/1.1" 500 205387
Internal Server Error: /facebook_app/facebook_get-followers-city/
Traceback (most recent call last):
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "D:\Predicta Digital\phase3\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Predicta Digital\phase3\predicta_api\facebook_app\FB_Followers_by_City.py", line 61, in get
    sincedates = now - timedelta(day=1)  # Rough estimate (93 Days)
                       ^^^^^^^^^^^^^^^^
TypeError: 'day' is an invalid keyword argument for __new__()
"GET /facebook_app/facebook_get-followers-city/ HTTP/1.1" 500 97535
Internal Server Error: /auth/service-auth/
Traceback (most recent call last):
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/views/decorators/csrf.py", line 56, in wrapper_view
    return view_func(*args, **kwargs)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/views/generic/base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 480, in raise_uncaught_exception
    raise exc
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
TypeError: get() missing 1 required positional argument: 'email'
"GET /auth/service-auth/ HTTP/1.1" 500 92704
Internal Server Error: /auth/service-auth/
Traceback (most recent call last):
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/views/decorators/csrf.py", line 56, in wrapper_view
    return view_func(*args, **kwargs)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/views/generic/base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 480, in raise_uncaught_exception
    raise exc
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
TypeError: get() missing 1 required positional argument: 'email'
"GET /auth/service-auth/ HTTP/1.1" 500 92841
Internal Server Error: /auth/service-auth/
Traceback (most recent call last):
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/views/decorators/csrf.py", line 56, in wrapper_view
    return view_func(*args, **kwargs)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/views/generic/base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 480, in raise_uncaught_exception
    raise exc
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
TypeError: get() missing 1 required positional argument: 'email'
"GET /auth/service-auth/ HTTP/1.1" 500 92841
Internal Server Error: /auth/service-auth/
Traceback (most recent call last):
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/views/decorators/csrf.py", line 56, in wrapper_view
    return view_func(*args, **kwargs)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/django/views/generic/base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 480, in raise_uncaught_exception
    raise exc
  File "/home/dev/Downloads/wetransfer_linkedin-main-1-zip_2025-02-02_1445/Facebook_API-main/predicta_api/venv/lib/python3.8/site-packages/rest_framework/views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
TypeError: get() missing 1 required positional argument: 'email'
"GET /auth/service-auth/ HTTP/1.1" 500 92841
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 65
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 65
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 122
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 65
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 65
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 65
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 65
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 48
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 122
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 31
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 31
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 122
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 45
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 65
Internal Server Error: /facebook/facebook-api/
Traceback (most recent call last):
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 220, in _get_response
    response = response.render()
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/template/response.py", line 114, in render
    self.content = self.rendered_content
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/response.py", line 74, in rendered_content
    ret = renderer.render(self.data, accepted_media_type, context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 100, in render
    ret = json.dumps(
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/utils/json.py", line 25, in dumps
    return json.dumps(*args, **kwargs)
  File "/usr/lib/python3.8/json/__init__.py", line 234, in dumps
    return cls(
  File "/usr/lib/python3.8/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.8/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/utils/encoders.py", line 67, in default
    return super().default(obj)
  File "/usr/lib/python3.8/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Response is not JSON serializable
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=123456 HTTP/1.1" 500 105065
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com&code=12345689 HTTP/1.1" 500 42
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5555
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5555
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5555
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5555
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5555
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5555
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5557
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook/facebook-api/
Traceback (most recent call last):
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 220, in _get_response
    response = response.render()
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/template/response.py", line 114, in render
    self.content = self.rendered_content
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/response.py", line 74, in rendered_content
    ret = renderer.render(self.data, accepted_media_type, context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 727, in render
    context = self.get_context(data, accepted_media_type, renderer_context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 683, in get_context
    'content': self.get_content(renderer, data, accepted_media_type, renderer_context),
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 413, in get_content
    content = renderer.render(data, accepted_media_type, renderer_context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 100, in render
    ret = json.dumps(
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/utils/json.py", line 25, in dumps
    return json.dumps(*args, **kwargs)
  File "/usr/lib/python3.8/json/__init__.py", line 234, in dumps
    return cls(
  File "/usr/lib/python3.8/json/encoder.py", line 201, in encode
    chunks = list(chunks)
  File "/usr/lib/python3.8/json/encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/usr/lib/python3.8/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "/usr/lib/python3.8/json/encoder.py", line 438, in _iterencode
    o = _default(o)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/utils/encoders.py", line 67, in default
    return super().default(obj)
  File "/usr/lib/python3.8/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Response is not JSON serializable
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 146498
Internal Server Error: /facebook/facebook-api/
Traceback (most recent call last):
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 220, in _get_response
    response = response.render()
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/template/response.py", line 114, in render
    self.content = self.rendered_content
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/response.py", line 74, in rendered_content
    ret = renderer.render(self.data, accepted_media_type, context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 727, in render
    context = self.get_context(data, accepted_media_type, renderer_context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 683, in get_context
    'content': self.get_content(renderer, data, accepted_media_type, renderer_context),
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 413, in get_content
    content = renderer.render(data, accepted_media_type, renderer_context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 100, in render
    ret = json.dumps(
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/utils/json.py", line 25, in dumps
    return json.dumps(*args, **kwargs)
  File "/usr/lib/python3.8/json/__init__.py", line 234, in dumps
    return cls(
  File "/usr/lib/python3.8/json/encoder.py", line 201, in encode
    chunks = list(chunks)
  File "/usr/lib/python3.8/json/encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/usr/lib/python3.8/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "/usr/lib/python3.8/json/encoder.py", line 438, in _iterencode
    o = _default(o)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/utils/encoders.py", line 67, in default
    return super().default(obj)
  File "/usr/lib/python3.8/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Response is not JSON serializable
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 146515
Internal Server Error: /facebook/facebook-api/
Traceback (most recent call last):
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 220, in _get_response
    response = response.render()
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/template/response.py", line 114, in render
    self.content = self.rendered_content
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/response.py", line 74, in rendered_content
    ret = renderer.render(self.data, accepted_media_type, context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 727, in render
    context = self.get_context(data, accepted_media_type, renderer_context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 683, in get_context
    'content': self.get_content(renderer, data, accepted_media_type, renderer_context),
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 413, in get_content
    content = renderer.render(data, accepted_media_type, renderer_context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 100, in render
    ret = json.dumps(
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/utils/json.py", line 25, in dumps
    return json.dumps(*args, **kwargs)
  File "/usr/lib/python3.8/json/__init__.py", line 234, in dumps
    return cls(
  File "/usr/lib/python3.8/json/encoder.py", line 201, in encode
    chunks = list(chunks)
  File "/usr/lib/python3.8/json/encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/usr/lib/python3.8/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "/usr/lib/python3.8/json/encoder.py", line 438, in _iterencode
    o = _default(o)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/utils/encoders.py", line 67, in default
    return super().default(obj)
  File "/usr/lib/python3.8/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Response is not JSON serializable
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 146596
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook/facebook-api/
Traceback (most recent call last):
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 220, in _get_response
    response = response.render()
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/template/response.py", line 114, in render
    self.content = self.rendered_content
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/response.py", line 74, in rendered_content
    ret = renderer.render(self.data, accepted_media_type, context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 727, in render
    context = self.get_context(data, accepted_media_type, renderer_context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 683, in get_context
    'content': self.get_content(renderer, data, accepted_media_type, renderer_context),
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 413, in get_content
    content = renderer.render(data, accepted_media_type, renderer_context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 100, in render
    ret = json.dumps(
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/utils/json.py", line 25, in dumps
    return json.dumps(*args, **kwargs)
  File "/usr/lib/python3.8/json/__init__.py", line 234, in dumps
    return cls(
  File "/usr/lib/python3.8/json/encoder.py", line 201, in encode
    chunks = list(chunks)
  File "/usr/lib/python3.8/json/encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/usr/lib/python3.8/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "/usr/lib/python3.8/json/encoder.py", line 438, in _iterencode
    o = _default(o)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/utils/encoders.py", line 67, in default
    return super().default(obj)
  File "/usr/lib/python3.8/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Response is not JSON serializable
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 158657
Internal Server Error: /facebook/facebook-api/
"GET /facebook/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5524
Internal Server Error: /facebook_app/facebook-api/
"GET /facebook_app/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5555
Internal Server Error: /facebook_app/facebook-api/
"GET /facebook_app/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5657
Internal Server Error: /facebook_app/facebook-api/
"GET /facebook_app/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5657
Internal Server Error: /facebook_app/facebook-api/
"GET /facebook_app/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5657
Internal Server Error: /facebook_app/facebook-api/
Traceback (most recent call last):
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 220, in _get_response
    response = response.render()
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/template/response.py", line 114, in render
    self.content = self.rendered_content
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/response.py", line 74, in rendered_content
    ret = renderer.render(self.data, accepted_media_type, context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 727, in render
    context = self.get_context(data, accepted_media_type, renderer_context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 683, in get_context
    'content': self.get_content(renderer, data, accepted_media_type, renderer_context),
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 413, in get_content
    content = renderer.render(data, accepted_media_type, renderer_context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/renderers.py", line 100, in render
    ret = json.dumps(
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/utils/json.py", line 25, in dumps
    return json.dumps(*args, **kwargs)
  File "/usr/lib/python3.8/json/__init__.py", line 234, in dumps
    return cls(
  File "/usr/lib/python3.8/json/encoder.py", line 201, in encode
    chunks = list(chunks)
  File "/usr/lib/python3.8/json/encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/usr/lib/python3.8/json/encoder.py", line 405, in _iterencode_dict
    yield from chunks
  File "/usr/lib/python3.8/json/encoder.py", line 438, in _iterencode
    o = _default(o)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/utils/encoders.py", line 67, in default
    return super().default(obj)
  File "/usr/lib/python3.8/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Response is not JSON serializable
"GET /facebook_app/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 145109
Internal Server Error: /facebook_app/facebook-api/
"GET /facebook_app/facebook-api/?email=tarsemkohli97@gmail.com HTTP/1.1" 500 5581
Internal Server Error: /facebook_app/facebook-api/
"GET /facebook_app/facebook-api/?email=admin@gmail.com HTTP/1.1" 500 5512
Internal Server Error: /instagram/fetch-instagram-insights/
Traceback (most recent call last):
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/views/decorators/csrf.py", line 56, in wrapper_view
    return view_func(*args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/views/generic/base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 480, in raise_uncaught_exception
    raise exc
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/instagram/views.py", line 303, in get
    instagram_data = fetch_instagram_insights(email)
  File "/home/dev/project/git_linkedin_project/pedicta_social/instagram/views.py", line 45, in fetch_instagram_insights
    email = fb_oauth_details['email']
KeyError: 'email'
"GET /instagram/fetch-instagram-insights/?email=admin@gmail.com HTTP/1.1" 500 102744
Internal Server Error: /instagram/fetch-instagram-insights/
Traceback (most recent call last):
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/views/decorators/csrf.py", line 56, in wrapper_view
    return view_func(*args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/views/generic/base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 480, in raise_uncaught_exception
    raise exc
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/instagram/views.py", line 304, in get
    instagram_data = fetch_instagram_insights(email)
  File "/home/dev/project/git_linkedin_project/pedicta_social/instagram/views.py", line 45, in fetch_instagram_insights
    email = fb_oauth_details['email']
KeyError: 'email'
"GET /instagram/fetch-instagram-insights/?email=admin@gmail.com HTTP/1.1" 500 102914
Internal Server Error: /instagram/fetch-instagram-insights/
Traceback (most recent call last):
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/backends/utils.py", line 89, in _execute
    return self.cursor.execute(sql, params)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
sqlite3.IntegrityError: NOT NULL constraint failed: Instagram_Media_Insights.email

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/views/decorators/csrf.py", line 56, in wrapper_view
    return view_func(*args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/views/generic/base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 480, in raise_uncaught_exception
    raise exc
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/instagram/views.py", line 304, in get
    instagram_data = fetch_instagram_insights(email)
  File "/home/dev/project/git_linkedin_project/pedicta_social/instagram/views.py", line 84, in fetch_instagram_insights
    post = InstagramMediaInsight.objects.create(
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/models/query.py", line 658, in create
    obj.save(force_insert=True, using=self.db)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/models/base.py", line 814, in save
    self.save_base(
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/models/base.py", line 877, in save_base
    updated = self._save_table(
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/models/base.py", line 1020, in _save_table
    results = self._do_insert(
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/models/base.py", line 1061, in _do_insert
    return manager._insert(
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/models/query.py", line 1805, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/models/sql/compiler.py", line 1822, in execute_sql
    cursor.execute(sql, params)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/backends/utils.py", line 102, in execute
    return super().execute(sql, params)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/backends/utils.py", line 67, in execute
    return self._execute_with_wrappers(
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/backends/utils.py", line 80, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/backends/utils.py", line 89, in _execute
    return self.cursor.execute(sql, params)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/backends/utils.py", line 89, in _execute
    return self.cursor.execute(sql, params)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
django.db.utils.IntegrityError: NOT NULL constraint failed: Instagram_Media_Insights.email
"GET /instagram/fetch-instagram-insights/?email=admin@gmail.com HTTP/1.1" 500 244583
Internal Server Error: /instagram/fetch-instagram-insights/
Traceback (most recent call last):
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/views/decorators/csrf.py", line 56, in wrapper_view
    return view_func(*args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/views/generic/base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 480, in raise_uncaught_exception
    raise exc
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/instagram/views.py", line 318, in get
    "Instagram Page Insights": instagram_Page_insigths,
NameError: name 'instagram_Page_insigths' is not defined
"GET /instagram/fetch-instagram-insights/?email=admin@gmail.com HTTP/1.1" 500 103402
Internal Server Error: /instagram/fetch-instagram-insights/
Traceback (most recent call last):
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/views/decorators/csrf.py", line 56, in wrapper_view
    return view_func(*args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/views/generic/base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 480, in raise_uncaught_exception
    raise exc
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/instagram/views.py", line 305, in get
    instagram_Page_insigths = fetch_insta_page_insights(email)
  File "/home/dev/project/git_linkedin_project/pedicta_social/instagram/views.py", line 157, in fetch_insta_page_insights
    endpoint = f"https://graph.facebook.com/v21.0/{insta_id}/insights"
NameError: name 'insta_id' is not defined
"GET /instagram/fetch-instagram-insights/?email=admin@gmail.com HTTP/1.1" 500 103611
Internal Server Error: /instagram/fetch-instagram-insights/
Traceback (most recent call last):
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/views/decorators/csrf.py", line 56, in wrapper_view
    return view_func(*args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/views/generic/base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 480, in raise_uncaught_exception
    raise exc
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/instagram/views.py", line 305, in get
    instagram_Page_insigths = fetch_insta_page_insights(email)
  File "/home/dev/project/git_linkedin_project/pedicta_social/instagram/views.py", line 208, in fetch_insta_page_insights
    page_id=insta_id,
NameError: name 'insta_id' is not defined
"GET /instagram/fetch-instagram-insights/?email=admin@gmail.com HTTP/1.1" 500 126197
Internal Server Error: /instagram/fetch-instagram-insights/
Traceback (most recent call last):
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/views/decorators/csrf.py", line 56, in wrapper_view
    return view_func(*args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/django/views/generic/base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 509, in dispatch
    response = self.handle_exception(exc)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 480, in raise_uncaught_exception
    raise exc
  File "/home/dev/project/git_linkedin_project/pedicta_social/venv/lib/python3.8/site-packages/rest_framework/views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
  File "/home/dev/project/git_linkedin_project/pedicta_social/instagram/views.py", line 317, in get
    "Instagram Media": instagram_data,
NameError: name 'instagram_data' is not defined
"GET /instagram/fetch-instagram-insights/?email=admin@gmail.com HTTP/1.1" 500 102315
Internal Server Error: /google/google-oauth/
Traceback (most recent call last):
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\google_app\views.py", line 105, in get
    flow = Flow.from_json(request.session['flow'])
           ^^^^
NameError: name 'Flow' is not defined
"GET /google/google-oauth/ HTTP/1.1" 500 95644
Internal Server Error: /google/google-oauth/
Traceback (most recent call last):
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\google_app\views.py", line 109, in get
    flow = Flow.from_json(request.session['flow'])
           ^^^^^^^^^^^^^^
AttributeError: type object 'Flow' has no attribute 'from_json'
"GET /google/google-oauth/ HTTP/1.1" 500 95913
Internal Server Error: /
Traceback (most recent call last):
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\google_app\views.py", line 168, in get
    flow.fetch_token(authorization_response=request.build_absolute_uri())
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\google_auth_oauthlib\flow.py", line 285, in fetch_token
    return self.oauth2session.fetch_token(self.client_config["token_uri"], **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\requests_oauthlib\oauth2_session.py", line 271, in fetch_token
    self._client.parse_request_uri_response(
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\oauthlib\oauth2\rfc6749\clients\web_application.py", line 220, in parse_request_uri_response
    response = parse_authorization_code_response(uri, state=state)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\oauthlib\oauth2\rfc6749\parameters.py", line 272, in parse_authorization_code_response
    raise InsecureTransportError()
oauthlib.oauth2.rfc6749.errors.InsecureTransportError: (insecure_transport) OAuth 2 MUST utilize https.
"GET /?state=%7B%22user_id%22:%20%2212312112%22%7D&code=4/0ASVgi3LGLaOBMOALnA14CMQs9ZeamC8ouKpy9TTHqrH_9ckv95MDkW_ybaMm1jLIHtLkrw&scope=https://www.googleapis.com/auth/analytics.readonly%20https://www.googleapis.com/auth/webmasters.readonly HTTP/1.1" 500 120254
Internal Server Error: /
Traceback (most recent call last):
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\db\backends\base\base.py", line 299, in _commit
    return self.connection.commit()
           ^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.IntegrityError: FOREIGN KEY constraint failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\google_app\views.py", line 174, in get
    google_creds, created = GoogleCredentials.objects.update_or_create(
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\db\models\query.py", line 983, in update_or_create
    with transaction.atomic(using=self.db):
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\db\transaction.py", line 263, in __exit__
    connection.commit()
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\utils\asyncio.py", line 26, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\db\backends\base\base.py", line 323, in commit
    self._commit()
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\db\backends\base\base.py", line 298, in _commit
    with debug_transaction(self, "COMMIT"), self.wrap_database_errors:
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\db\backends\base\base.py", line 299, in _commit
    return self.connection.commit()
           ^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.IntegrityError: FOREIGN KEY constraint failed
"GET /?state=%7B%22user_id%22:%20%2212312112%22%7D&code=4/0ASVgi3K7p94uWflTMsdupBzfx_-skTFAi-0-z3QbzswLUap7zgpP7j2VtIqNw1FVt1Opqg&scope=https://www.googleapis.com/auth/analytics.readonly%20https://www.googleapis.com/auth/webmasters.readonly HTTP/1.1" 500 141974
Internal Server Error: /
Traceback (most recent call last):
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\google_app\views.py", line 110, in get
    flow.fetch_token(authorization_response=request.build_absolute_uri())
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\google_auth_oauthlib\flow.py", line 285, in fetch_token
    return self.oauth2session.fetch_token(self.client_config["token_uri"], **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\requests_oauthlib\oauth2_session.py", line 271, in fetch_token
    self._client.parse_request_uri_response(
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\oauthlib\oauth2\rfc6749\clients\web_application.py", line 220, in parse_request_uri_response
    response = parse_authorization_code_response(uri, state=state)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\oauthlib\oauth2\rfc6749\parameters.py", line 281, in parse_authorization_code_response
    raise_from_error(params.get('error'), params)
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\oauthlib\oauth2\rfc6749\errors.py", line 399, in raise_from_error
    raise cls(**kwargs)
oauthlib.oauth2.rfc6749.errors.AccessDeniedError: (access_denied) 
"GET /?error=access_denied&state=%7B%22user_id%22:%20%22tushar.predicta@gmail.com%22%7D HTTP/1.1" 500 121958
Internal Server Error: /facebook_app/callback/
Traceback (most recent call last):
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\facebook_app\FacebookCallback.py", line 14, in get
    state_data = parse_qs(state_param)
                 ^^^^^^^^
NameError: name 'parse_qs' is not defined
"GET /facebook_app/callback/?code=AQDCoB42PS_cD1Q0oeD9hDHlH6qntiIwz1V_2tb4DtkfVv__aYdwD-hIfrL6NRUfGpz4LqGTu5s-lPGxZk3i7qmJ10V_friwT44KevdNWhf2vz_cgeyWJYTeFgTntRPcPswmjVw8dGJ134X_GzORugeHwcPpdn6qCOOP2cCLoMQUWUXq7c1ocxQ-1FJ3pPX-b9VExuqg4xz8tQnOvf2CDbr4xQvTGNmyTfkptwCB63ZjFpJ374pXwpVYIrEXJQO--T878ag0C1Dt12EBY6lpRSGGFWKUTbbn5UlO0gqK5kwhl2URY5dWYex_TUwFTTvHTHAEp47KYCMAXILc7cHvDVv55D_MuiuvlNGWjyuHFV0PcDNpZb48mlllQno7wDPod1o&state=email%3Dtushar.predicta%40gmail.com HTTP/1.1" 500 102349
Internal Server Error: /facebook_app/callback/
Traceback (most recent call last):
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\views\decorators\csrf.py", line 65, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\views\generic\base.py", line 104, in view
    return self.dispatch(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 509, in dispatch
    response = self.handle_exception(exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 469, in handle_exception
    self.raise_uncaught_exception(exc)
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 480, in raise_uncaught_exception
    raise exc
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\rest_framework\views.py", line 506, in dispatch
    response = handler(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\facebook_app\FacebookCallback.py", line 49, in get
    data = FB_Oauth(
           ^^^^^^^^^
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\db\models\base.py", line 543, in __init__
    _setattr(self, field.name, rel_obj)
  File "E:\git-code\perdicta-social\pedicta_social\venv\Lib\site-packages\django\db\models\fields\related_descriptors.py", line 284, in __set__
    raise ValueError(
ValueError: Cannot assign "'tushar.predicta@gmail.com'": "FB_Oauth.social_user" must be a "SocialUser" instance.
"GET /facebook_app/callback/?code=AQBtQAnICb-D_LuZFFqltJCjiMMokQ7pk6Iy-LMAIX9ULOmNiLd3sBq06kywVTwxAepJO7Yw6W-_lyQ7F_D8oY2qeJn5si12qbU9GRPXGykNe9OCwDBqMhx2lofrZx7iV1c6j5DVpMydRz561rsouoK0SSOGxHLlI_uHNL_5X-KgptvbOZthDyhiCyqUDyCQzMEkagS6LzZxWXyb7L7xQRv3aFlgBs0HeoP8wCfRKg3Rv0F2IzJ9edJnwLxp5Qw8DpIeXOqN7iuGzbRcW3EmaayrxCq2a7WtHkpJeYjY5glK9MUml5hcxgc2eSmBwetueMLrLaGFsbGjCFS52-c9NGBMXw5OBfOLQWqjcQ8K5n1HlEcE9Cof3f8C1Gih-zilGvM&state=email%3Dtushar.predicta%40gmail.com HTTP/1.1" 500 117318
